<FULL CODE INSERTED FROM THE DOCUMENT CANVAS — OMITTED HERE FOR BREVITY>